//
//  nvc_ui_font.cpp
//  NVim
//
//  Created by wizjin on 2023/10/14.
//

#include "nvc_ui_font.h"
#include "nvc_util.h"

namespace nvc {

class UICharacterSet {
private:
    CFMutableCharacterSetRef   m_emojiSet;

    explicit UICharacterSet();
public:
    ~UICharacterSet() {
        if (m_emojiSet != nullptr) {
            CFRelease(m_emojiSet);
            m_emojiSet = nullptr;
        }
    }
    
    inline bool is_emoji(UTF32Char ch) const {
        return m_emojiSet != nullptr && CFCharacterSetIsLongCharacterMember(m_emojiSet, ch);
    }
    
    inline const UICharacterSet& shared(void) {
        return g_character_set;
    }
private:
    static UICharacterSet g_character_set;
};

UICharacterSet UICharacterSet::g_character_set;

UIFont::UIFont() {
    
}

UIFont::~UIFont() {
    clear();
}

void UIFont::clear(void) {
    std::for_each(m_fonts.begin(), m_fonts.end(), CFRelease);
    m_fonts.clear();
}

UIFont& UIFont::operator=(const UIFont& other) {
    if (this != &other) {
        clear();
        for (const auto& p : other.m_fonts) {
            m_fonts.push_back((CTFontRef)CFRetain(p));
        }
    }
    return *this;
}


#pragma mark - UICharacterSet
#define NVC_UI_CHAR_RANGE(_c, _n)   { .location = _c, .length = _n }
UICharacterSet::UICharacterSet() {
    CFRangeMake(0, 1);
    CFRange emojis[] = {
        // Note: https://www.unicode.org/Public/15.1.0/ucd/emoji/emoji-data.txt
        NVC_UI_CHAR_RANGE(0x2139, 1),   // (‚ÑπÔ∏è)        information
        NVC_UI_CHAR_RANGE(0x2194, 6),   // (‚ÜîÔ∏è..‚ÜôÔ∏è)    left-right arrow..down-left arrow
        NVC_UI_CHAR_RANGE(0x21A9, 2),   // (‚Ü©Ô∏è..‚Ü™Ô∏è)    right arrow curving left..left arrow curving right
        NVC_UI_CHAR_RANGE(0x231A, 2),   // (‚åö..‚åõ)    watch..hourglass done
        NVC_UI_CHAR_RANGE(0x2328, 1),   // (‚å®Ô∏è)        keyboard
        NVC_UI_CHAR_RANGE(0x23CF, 1),   // (‚èèÔ∏è)        eject button
        NVC_UI_CHAR_RANGE(0x23E9, 4),   // (‚è©..‚è¨)    fast-forward button..fast down button
        NVC_UI_CHAR_RANGE(0x23ED, 2),   // (‚è≠Ô∏è..‚èÆÔ∏è)    next track button..last track button
        NVC_UI_CHAR_RANGE(0x23EF, 1),   // (‚èØÔ∏è)        play or pause button
        NVC_UI_CHAR_RANGE(0x23F0, 1),   // (‚è∞)        alarm clock
        NVC_UI_CHAR_RANGE(0x23F1, 2),   // (‚è±Ô∏è..‚è≤Ô∏è)    stopwatch..timer clock
        NVC_UI_CHAR_RANGE(0x23F3, 1),   // (‚è≥)        hourglass not done
        NVC_UI_CHAR_RANGE(0x23F8, 3),   // (‚è∏Ô∏è..‚è∫Ô∏è)    pause button..record button
        NVC_UI_CHAR_RANGE(0x24C2, 1),   // (‚ìÇÔ∏è)        circled M
        NVC_UI_CHAR_RANGE(0x25AA, 2),   // (‚ñ™Ô∏è..‚ñ´Ô∏è)    black small square..white small square
        NVC_UI_CHAR_RANGE(0x25B6, 1),   // (‚ñ∂Ô∏è)        play button
        NVC_UI_CHAR_RANGE(0x25C0, 1),   // (‚óÄÔ∏è)        reverse button
        NVC_UI_CHAR_RANGE(0x25FB, 4),   // (‚óªÔ∏è..‚óæ)    white medium square..black medium-small square
        NVC_UI_CHAR_RANGE(0x2600, 2),   // (‚òÄÔ∏è..‚òÅÔ∏è)    sun..cloud
        NVC_UI_CHAR_RANGE(0x2602, 2),   // (‚òÇÔ∏è..‚òÉÔ∏è)    umbrella..snowman
        NVC_UI_CHAR_RANGE(0x2604, 1),   // (‚òÑÔ∏è)        comet
        NVC_UI_CHAR_RANGE(0x260E, 1),   // (‚òéÔ∏è)        telephone
        NVC_UI_CHAR_RANGE(0x2611, 1),   // (‚òëÔ∏è)        check box with check
        NVC_UI_CHAR_RANGE(0x2614, 2),   // (‚òî..‚òï)    umbrella with rain drops..hot beverage
        NVC_UI_CHAR_RANGE(0x2618, 1),   // (‚òòÔ∏è)        shamrock
        NVC_UI_CHAR_RANGE(0x261D, 1),   // (‚òùÔ∏è)        index pointing up
        NVC_UI_CHAR_RANGE(0x2620, 1),   // (‚ò†Ô∏è)        skull and crossbones
        NVC_UI_CHAR_RANGE(0x2622, 2),   // (‚ò¢Ô∏è..‚ò£Ô∏è)    radioactive..biohazard
        NVC_UI_CHAR_RANGE(0x2626, 1),   // (‚ò¶Ô∏è)        orthodox cross
        NVC_UI_CHAR_RANGE(0x262A, 1),   // (‚ò™Ô∏è)        star and crescent
        NVC_UI_CHAR_RANGE(0x262E, 1),   // (‚òÆÔ∏è)        peace symbol
        NVC_UI_CHAR_RANGE(0x262F, 1),   // (‚òØÔ∏è)        yin yang
        NVC_UI_CHAR_RANGE(0x2638, 2),   // (‚ò∏Ô∏è..‚òπÔ∏è)    wheel of dharma..frowning face
        NVC_UI_CHAR_RANGE(0x263A, 1),   // (‚ò∫Ô∏è)        smiling face
        NVC_UI_CHAR_RANGE(0x2640, 1),   // (‚ôÄÔ∏è)        female sign
        NVC_UI_CHAR_RANGE(0x2642, 1),   // (‚ôÇÔ∏è)        male sign
        NVC_UI_CHAR_RANGE(0x2648, 12),  // (‚ôà..‚ôì)    Aries..Pisces
        NVC_UI_CHAR_RANGE(0x265F, 1),   // (‚ôüÔ∏è)        chess pawn
        NVC_UI_CHAR_RANGE(0x2660, 1),   // (‚ô†Ô∏è)        spade suit
        NVC_UI_CHAR_RANGE(0x2663, 1),   // (‚ô£Ô∏è)        club suit
        NVC_UI_CHAR_RANGE(0x2665, 2),   // (‚ô•Ô∏è..‚ô¶Ô∏è)    heart suit..diamond suit
        NVC_UI_CHAR_RANGE(0x2668, 1),   // (‚ô®Ô∏è)        hot springs
        NVC_UI_CHAR_RANGE(0x267B, 1),   // (‚ôªÔ∏è)        recycling symbol
        NVC_UI_CHAR_RANGE(0x267E, 1),   // (‚ôæÔ∏è)        infinity
        NVC_UI_CHAR_RANGE(0x267F, 1),   // (‚ôø)        wheelchair symbol
        NVC_UI_CHAR_RANGE(0x2692, 1),   // (‚öíÔ∏è)        hammer and pick
        NVC_UI_CHAR_RANGE(0x2693, 1),   // (‚öì)        anchor
        NVC_UI_CHAR_RANGE(0x2694, 1),   // (‚öîÔ∏è)        crossed swords
        NVC_UI_CHAR_RANGE(0x2695, 1),   // (‚öïÔ∏è)        medical symbol
        NVC_UI_CHAR_RANGE(0x2696, 2),   // (‚öñÔ∏è..‚öóÔ∏è)    balance scale..alembic
        NVC_UI_CHAR_RANGE(0x2699, 1),   // (‚öôÔ∏è)        gear
        NVC_UI_CHAR_RANGE(0x269B, 2),   // (‚öõÔ∏è..‚öúÔ∏è)    atom symbol..fleur-de-lis
        NVC_UI_CHAR_RANGE(0x26A0, 2),   // (‚ö†Ô∏è..‚ö°)    warning..high voltage
        NVC_UI_CHAR_RANGE(0x26A7, 1),   // (‚ößÔ∏è)        transgender symbol
        NVC_UI_CHAR_RANGE(0x26AA, 2),   // (‚ö™..‚ö´)    white circle..black circle
        NVC_UI_CHAR_RANGE(0x26B0, 2),   // (‚ö∞Ô∏è..‚ö±Ô∏è)    coffin..funeral urn
        NVC_UI_CHAR_RANGE(0x26BD, 2),   // (‚öΩ..‚öæ)    soccer ball..baseball
        NVC_UI_CHAR_RANGE(0x26C4, 2),   // (‚õÑ..‚õÖ)    snowman without snow..sun behind cloud
        NVC_UI_CHAR_RANGE(0x26C8, 1),   // (‚õàÔ∏è)        cloud with lightning and rain
        NVC_UI_CHAR_RANGE(0x26CE, 1),   // (‚õé)        Ophiuchus
        NVC_UI_CHAR_RANGE(0x26CF, 1),   // (‚õèÔ∏è)        pick
        NVC_UI_CHAR_RANGE(0x26D1, 1),   // (‚õëÔ∏è)        rescue worker‚Äôs helmet
        NVC_UI_CHAR_RANGE(0x26D3, 1),   // (‚õìÔ∏è)        chains
        NVC_UI_CHAR_RANGE(0x26D4, 1),   // (‚õî)        no entry
        NVC_UI_CHAR_RANGE(0x26E9, 1),   // (‚õ©Ô∏è)        shinto shrine
        NVC_UI_CHAR_RANGE(0x26EA, 1),   // (‚õ™)        church
        NVC_UI_CHAR_RANGE(0x26F0, 2),   // (‚õ∞Ô∏è..‚õ±Ô∏è)    mountain..umbrella on ground
        NVC_UI_CHAR_RANGE(0x26F2, 2),   // (‚õ≤..‚õ≥)    fountain..flag in hole
        NVC_UI_CHAR_RANGE(0x26F4, 1),   // (‚õ¥Ô∏è)        ferry
        NVC_UI_CHAR_RANGE(0x26F5, 1),   // (‚õµ)        sailboat
        NVC_UI_CHAR_RANGE(0x26F7, 3),   // (‚õ∑Ô∏è..‚õπÔ∏è)    skier..person bouncing ball
        NVC_UI_CHAR_RANGE(0x26FA, 1),   // (‚õ∫)        tent
        NVC_UI_CHAR_RANGE(0x26FD, 1),   // (‚õΩ)        fuel pump
        NVC_UI_CHAR_RANGE(0x2702, 1),   // (‚úÇÔ∏è)        scissors
        NVC_UI_CHAR_RANGE(0x2705, 1),   // (‚úÖ)        check mark button
        NVC_UI_CHAR_RANGE(0x2708, 5),   // (‚úàÔ∏è..‚úåÔ∏è)    airplane..victory hand
        NVC_UI_CHAR_RANGE(0x270D, 1),   // (‚úçÔ∏è)        writing hand
        NVC_UI_CHAR_RANGE(0x270F, 1),   // (‚úèÔ∏è)        pencil
        NVC_UI_CHAR_RANGE(0x2712, 1),   // (‚úíÔ∏è)        black nib
        NVC_UI_CHAR_RANGE(0x2714, 1),   // (‚úîÔ∏è)        check mark
        NVC_UI_CHAR_RANGE(0x2716, 1),   // (‚úñÔ∏è)        multiply
        NVC_UI_CHAR_RANGE(0x271D, 1),   // (‚úùÔ∏è)        latin cross
        NVC_UI_CHAR_RANGE(0x2721, 1),   // (‚ú°Ô∏è)        star of David
        NVC_UI_CHAR_RANGE(0x2728, 1),   // (‚ú®)        sparkles
        NVC_UI_CHAR_RANGE(0x2733, 2),   // (‚ú≥Ô∏è..‚ú¥Ô∏è)    eight-spoked asterisk..eight-pointed star
        NVC_UI_CHAR_RANGE(0x2744, 1),   // (‚ùÑÔ∏è)        snowflake
        NVC_UI_CHAR_RANGE(0x2747, 1),   // (‚ùáÔ∏è)        sparkle
        NVC_UI_CHAR_RANGE(0x274C, 1),   // (‚ùå)        cross mark
        NVC_UI_CHAR_RANGE(0x274E, 1),   // (‚ùé)        cross mark button
        NVC_UI_CHAR_RANGE(0x2753, 3),   // (‚ùì..‚ùï)    red question mark exclamation mark
        NVC_UI_CHAR_RANGE(0x2757, 1),   // (‚ùó)        red exclamation mark
        NVC_UI_CHAR_RANGE(0x2763, 1),   // (‚ù£Ô∏è)        heart exclamation
        NVC_UI_CHAR_RANGE(0x2764, 1),   // (‚ù§Ô∏è)        red heart
        NVC_UI_CHAR_RANGE(0x2795, 3),   // (‚ûï..‚ûó)    plus
        NVC_UI_CHAR_RANGE(0x27A1, 1),   // (‚û°Ô∏è)        right arrow
        NVC_UI_CHAR_RANGE(0x27B0, 1),   // (‚û∞)        curly loop
        NVC_UI_CHAR_RANGE(0x27BF, 1),   // (‚ûø)        double curly loop
        NVC_UI_CHAR_RANGE(0x2934, 2),   // (‚§¥Ô∏è..‚§µÔ∏è)    right arrow curving up arrow curving down
        NVC_UI_CHAR_RANGE(0x2B05, 3),   // (‚¨ÖÔ∏è..‚¨áÔ∏è)    left arrow arrow
        NVC_UI_CHAR_RANGE(0x2B1B, 2),   // (‚¨õ..‚¨ú)    black large square large square
        NVC_UI_CHAR_RANGE(0x2B50, 1),   // (‚≠ê)        star
        NVC_UI_CHAR_RANGE(0x2B55, 1),   // (‚≠ï)        hollow red circle
        NVC_UI_CHAR_RANGE(0x3030, 1),   // („Ä∞Ô∏è)        wavy dash
        NVC_UI_CHAR_RANGE(0x303D, 1),   // („ÄΩÔ∏è)        part alternation mark
        NVC_UI_CHAR_RANGE(0x3297, 1),   // („äóÔ∏è)        Japanese ‚Äúcongratulations‚Äù button
        NVC_UI_CHAR_RANGE(0x3299, 1),   // („äôÔ∏è)        Japanese ‚Äúsecret‚Äù button
        NVC_UI_CHAR_RANGE(0x1F004, 1),   // (üÄÑ)       mahjong red dragon
        NVC_UI_CHAR_RANGE(0x1F0CF, 1),   // (üÉè)       joker
        NVC_UI_CHAR_RANGE(0x1F170, 2),   // (üÖ∞Ô∏è..üÖ±Ô∏è)   A button (blood type) button (blood type)
        NVC_UI_CHAR_RANGE(0x1F17E, 2),   // (üÖæÔ∏è..üÖøÔ∏è)   O button (blood type) button
        NVC_UI_CHAR_RANGE(0x1F18E, 1),   // (üÜé)       AB button (blood type)
        NVC_UI_CHAR_RANGE(0x1F191, 10),  // (üÜë..üÜö)   CL button button
        NVC_UI_CHAR_RANGE(0x1F1E6, 26),  // (üá¶..üáø)   regional indicator symbol letter a indicator symbol letter z
        NVC_UI_CHAR_RANGE(0x1F201, 2),   // (üàÅ..üàÇÔ∏è)   Japanese ‚Äúhere‚Äù button ‚Äúservice charge‚Äù button
        NVC_UI_CHAR_RANGE(0x1F21A, 1),   // (üàö)       Japanese ‚Äúfree of charge‚Äù button
        NVC_UI_CHAR_RANGE(0x1F22F, 1),   // (üàØ)       Japanese ‚Äúreserved‚Äù button
        NVC_UI_CHAR_RANGE(0x1F232, 9),   // (üà≤..üà∫)   Japanese ‚Äúprohibited‚Äù button ‚Äúopen for business‚Äù button
        NVC_UI_CHAR_RANGE(0x1F250, 2),   // (üâê..üâë)   Japanese ‚Äúbargain‚Äù button ‚Äúacceptable‚Äù button
        NVC_UI_CHAR_RANGE(0x1F300, 13),  // (üåÄ..üåå)   cyclone way
        NVC_UI_CHAR_RANGE(0x1F30D, 2),   // (üåç..üåé)   globe showing Europe-Africa showing Americas
        NVC_UI_CHAR_RANGE(0x1F30F, 1),   // (üåè)       globe showing Asia-Australia
        NVC_UI_CHAR_RANGE(0x1F310, 1),   // (üåê)       globe with meridians
        NVC_UI_CHAR_RANGE(0x1F311, 1),   // (üåë)       new moon
        NVC_UI_CHAR_RANGE(0x1F312, 1),   // (üåí)       waxing crescent moon
        NVC_UI_CHAR_RANGE(0x1F313, 3),   // (üåì..üåï)   first quarter moon moon
        NVC_UI_CHAR_RANGE(0x1F316, 3),   // (üåñ..üåò)   waning gibbous moon crescent moon
        NVC_UI_CHAR_RANGE(0x1F319, 1),   // (üåô)       crescent moon
        NVC_UI_CHAR_RANGE(0x1F31A, 1),   // (üåö)       new moon face
        NVC_UI_CHAR_RANGE(0x1F31B, 1),   // (üåõ)       first quarter moon face
        NVC_UI_CHAR_RANGE(0x1F31C, 1),   // (üåú)       last quarter moon face
        NVC_UI_CHAR_RANGE(0x1F31D, 2),   // (üåù..üåû)   full moon face with face
        NVC_UI_CHAR_RANGE(0x1F31F, 2),   // (üåü..üå†)   glowing star star
        NVC_UI_CHAR_RANGE(0x1F321, 1),   // (üå°Ô∏è)       thermometer
        NVC_UI_CHAR_RANGE(0x1F324, 9),   // (üå§Ô∏è..üå¨Ô∏è)   sun behind small cloud face
        NVC_UI_CHAR_RANGE(0x1F32D, 3),   // (üå≠..üåØ)   hot dog
        NVC_UI_CHAR_RANGE(0x1F330, 2),   // (üå∞..üå±)   chestnut
        NVC_UI_CHAR_RANGE(0x1F332, 2),   // (üå≤..üå≥)   evergreen tree tree
        NVC_UI_CHAR_RANGE(0x1F334, 2),   // (üå¥..üåµ)   palm tree
        NVC_UI_CHAR_RANGE(0x1F336, 1),   // (üå∂Ô∏è)       hot pepper
        NVC_UI_CHAR_RANGE(0x1F337, 20),  // (üå∑..üçä)   tulip
        NVC_UI_CHAR_RANGE(0x1F34B, 1),   // (üçã)       lemon
        NVC_UI_CHAR_RANGE(0x1F34C, 4),   // (üçå..üçè)   banana apple
        NVC_UI_CHAR_RANGE(0x1F350, 1),   // (üçê)       pear
        NVC_UI_CHAR_RANGE(0x1F351, 43),  // (üçë..üçª)   peach beer mugs
        NVC_UI_CHAR_RANGE(0x1F37C, 1),   // (üçº)       baby bottle
        NVC_UI_CHAR_RANGE(0x1F37D, 1),   // (üçΩÔ∏è)       fork and knife with plate
        NVC_UI_CHAR_RANGE(0x1F37E, 2),   // (üçæ..üçø)   bottle with popping cork
        NVC_UI_CHAR_RANGE(0x1F380, 20),  // (üéÄ..üéì)   ribbon cap
        NVC_UI_CHAR_RANGE(0x1F396, 2),   // (üéñÔ∏è..üéóÔ∏è)   military medal ribbon
        NVC_UI_CHAR_RANGE(0x1F399, 3),   // (üéôÔ∏è..üéõÔ∏è)   studio microphone knobs
        NVC_UI_CHAR_RANGE(0x1F39E, 2),   // (üéûÔ∏è..üéüÔ∏è)   film frames tickets
        NVC_UI_CHAR_RANGE(0x1F3A0, 37),  // (üé†..üèÑ)   carousel horse surfing
        NVC_UI_CHAR_RANGE(0x1F3C5, 1),   // (üèÖ)       sports medal
        NVC_UI_CHAR_RANGE(0x1F3C6, 1),   // (üèÜ)       trophy
        NVC_UI_CHAR_RANGE(0x1F3C7, 1),   // (üèá)       horse racing
        NVC_UI_CHAR_RANGE(0x1F3C8, 1),   // (üèà)       american football
        NVC_UI_CHAR_RANGE(0x1F3C9, 1),   // (üèâ)       rugby football
        NVC_UI_CHAR_RANGE(0x1F3CA, 1),   // (üèä)       person swimming
        NVC_UI_CHAR_RANGE(0x1F3CB, 4),   // (üèãÔ∏è..üèéÔ∏è)   person lifting weights car
        NVC_UI_CHAR_RANGE(0x1F3CF, 5),   // (üèè..üèì)   cricket game pong
        NVC_UI_CHAR_RANGE(0x1F3D4, 12),  // (üèîÔ∏è..üèüÔ∏è)   snow-capped mountain
        NVC_UI_CHAR_RANGE(0x1F3E0, 4),   // (üè†..üè£)   house post office
        NVC_UI_CHAR_RANGE(0x1F3E4, 1),   // (üè§)       post office
        NVC_UI_CHAR_RANGE(0x1F3E5, 12),  // (üè•..üè∞)   hospital
        NVC_UI_CHAR_RANGE(0x1F3F3, 1),   // (üè≥Ô∏è)       white flag
        NVC_UI_CHAR_RANGE(0x1F3F4, 1),   // (üè¥)       black flag
        NVC_UI_CHAR_RANGE(0x1F3F5, 1),   // (üèµÔ∏è)       rosette
        NVC_UI_CHAR_RANGE(0x1F3F7, 1),   // (üè∑Ô∏è)       label
        NVC_UI_CHAR_RANGE(0x1F3F8, 16),  // (üè∏..üêá)   badminton
        NVC_UI_CHAR_RANGE(0x1F408, 1),   // (üêà)       cat
        NVC_UI_CHAR_RANGE(0x1F409, 3),   // (üêâ..üêã)   dragon
        NVC_UI_CHAR_RANGE(0x1F40C, 3),   // (üêå..üêé)   snail
        NVC_UI_CHAR_RANGE(0x1F40F, 2),   // (üêè..üêê)   ram
        NVC_UI_CHAR_RANGE(0x1F411, 2),   // (üêë..üêí)   ewe
        NVC_UI_CHAR_RANGE(0x1F413, 1),   // (üêì)       rooster
        NVC_UI_CHAR_RANGE(0x1F414, 1),   // (üêî)       chicken
        NVC_UI_CHAR_RANGE(0x1F415, 1),   // (üêï)       dog
        NVC_UI_CHAR_RANGE(0x1F416, 1),   // (üêñ)       pig
        NVC_UI_CHAR_RANGE(0x1F417, 19),  // (üêó..üê©)   boar
        NVC_UI_CHAR_RANGE(0x1F42A, 1),   // (üê™)       camel
        NVC_UI_CHAR_RANGE(0x1F42B, 20),  // (üê´..üêæ)   two-hump camel prints
        NVC_UI_CHAR_RANGE(0x1F43F, 1),   // (üêøÔ∏è)       chipmunk
        NVC_UI_CHAR_RANGE(0x1F440, 1),   // (üëÄ)       eyes
        NVC_UI_CHAR_RANGE(0x1F441, 1),   // (üëÅÔ∏è)       eye
        NVC_UI_CHAR_RANGE(0x1F442, 35),  // (üëÇ..üë§)   ear in silhouette
        NVC_UI_CHAR_RANGE(0x1F465, 1),   // (üë•)       busts in silhouette
        NVC_UI_CHAR_RANGE(0x1F466, 6),   // (üë¶..üë´)   boy and man holding hands
        NVC_UI_CHAR_RANGE(0x1F46C, 2),   // (üë¨..üë≠)   men holding hands holding hands
        NVC_UI_CHAR_RANGE(0x1F46E, 63),  // (üëÆ..üí¨)   police officer balloon
        NVC_UI_CHAR_RANGE(0x1F4AD, 1),   // (üí≠)       thought balloon
        NVC_UI_CHAR_RANGE(0x1F4AE, 8),   // (üíÆ..üíµ)   white flower banknote
        NVC_UI_CHAR_RANGE(0x1F4B6, 2),   // (üí∂..üí∑)   euro banknote banknote
        NVC_UI_CHAR_RANGE(0x1F4B8, 52),  // (üí∏..üì´)   money with wings mailbox with raised flag
        NVC_UI_CHAR_RANGE(0x1F4EC, 2),   // (üì¨..üì≠)   open mailbox with raised flag mailbox with lowered flag
        NVC_UI_CHAR_RANGE(0x1F4EE, 1),   // (üìÆ)       postbox
        NVC_UI_CHAR_RANGE(0x1F4EF, 1),   // (üìØ)       postal horn
        NVC_UI_CHAR_RANGE(0x1F4F0, 5),   // (üì∞..üì¥)   newspaper phone off
        NVC_UI_CHAR_RANGE(0x1F4F5, 1),   // (üìµ)       no mobile phones
        NVC_UI_CHAR_RANGE(0x1F4F6, 2),   // (üì∂..üì∑)   antenna bars
        NVC_UI_CHAR_RANGE(0x1F4F8, 1),   // (üì∏)       camera with flash
        NVC_UI_CHAR_RANGE(0x1F4F9, 4),   // (üìπ..üìº)   video camera
        NVC_UI_CHAR_RANGE(0x1F4FD, 1),   // (üìΩÔ∏è)       film projector
        NVC_UI_CHAR_RANGE(0x1F4FF, 4),   // (üìø..üîÇ)   prayer beads single button
        NVC_UI_CHAR_RANGE(0x1F503, 1),   // (üîÉ)       clockwise vertical arrows
        NVC_UI_CHAR_RANGE(0x1F504, 4),   // (üîÑ..üîá)   counterclockwise arrows button speaker
        NVC_UI_CHAR_RANGE(0x1F508, 1),   // (üîà)       speaker low volume
        NVC_UI_CHAR_RANGE(0x1F509, 1),   // (üîâ)       speaker medium volume
        NVC_UI_CHAR_RANGE(0x1F50A, 11),  // (üîä..üîî)   speaker high volume
        NVC_UI_CHAR_RANGE(0x1F515, 1),   // (üîï)       bell with slash
        NVC_UI_CHAR_RANGE(0x1F516, 22),  // (üîñ..üî´)   bookmark pistol
        NVC_UI_CHAR_RANGE(0x1F52C, 2),   // (üî¨..üî≠)   microscope
        NVC_UI_CHAR_RANGE(0x1F52E, 16),  // (üîÆ..üîΩ)   crystal ball button
        NVC_UI_CHAR_RANGE(0x1F549, 2),   // (üïâÔ∏è..üïäÔ∏è)   om
        NVC_UI_CHAR_RANGE(0x1F54B, 4),   // (üïã..üïé)   kaaba
        NVC_UI_CHAR_RANGE(0x1F550, 12),  // (üïê..üïõ)   one o‚Äôclock o‚Äôclock
        NVC_UI_CHAR_RANGE(0x1F55C, 12),  // (üïú..üïß)   one-thirty-thirty
        NVC_UI_CHAR_RANGE(0x1F56F, 2),   // (üïØÔ∏è..üï∞Ô∏è)   candle clock
        NVC_UI_CHAR_RANGE(0x1F573, 7),   // (üï≥Ô∏è..üïπÔ∏è)   hole
        NVC_UI_CHAR_RANGE(0x1F57A, 1),   // (üï∫)       man dancing
        NVC_UI_CHAR_RANGE(0x1F587, 1),   // (üñáÔ∏è)       linked paperclips
        NVC_UI_CHAR_RANGE(0x1F58A, 4),   // (üñäÔ∏è..üñçÔ∏è)   pen
        NVC_UI_CHAR_RANGE(0x1F590, 1),   // (üñêÔ∏è)       hand with fingers splayed
        NVC_UI_CHAR_RANGE(0x1F595, 2),   // (üñï..üññ)   middle finger salute
        NVC_UI_CHAR_RANGE(0x1F5A4, 1),   // (üñ§)       black heart
        NVC_UI_CHAR_RANGE(0x1F5A5, 1),   // (üñ•Ô∏è)       desktop computer
        NVC_UI_CHAR_RANGE(0x1F5A8, 1),   // (üñ®Ô∏è)       printer
        NVC_UI_CHAR_RANGE(0x1F5B1, 2),   // (üñ±Ô∏è..üñ≤Ô∏è)   computer mouse
        NVC_UI_CHAR_RANGE(0x1F5BC, 1),   // (üñºÔ∏è)       framed picture
        NVC_UI_CHAR_RANGE(0x1F5C2, 3),   // (üóÇÔ∏è..üóÑÔ∏è)   card index dividers cabinet
        NVC_UI_CHAR_RANGE(0x1F5D1, 3),   // (üóëÔ∏è..üóìÔ∏è)   wastebasket calendar
        NVC_UI_CHAR_RANGE(0x1F5DC, 3),   // (üóúÔ∏è..üóûÔ∏è)   clamp-up newspaper
        NVC_UI_CHAR_RANGE(0x1F5E1, 1),   // (üó°Ô∏è)       dagger
        NVC_UI_CHAR_RANGE(0x1F5E3, 1),   // (üó£Ô∏è)       speaking head
        NVC_UI_CHAR_RANGE(0x1F5E8, 1),   // (üó®Ô∏è)       left speech bubble
        NVC_UI_CHAR_RANGE(0x1F5EF, 1),   // (üóØÔ∏è)       right anger bubble
        NVC_UI_CHAR_RANGE(0x1F5F3, 1),   // (üó≥Ô∏è)       ballot box with ballot
        NVC_UI_CHAR_RANGE(0x1F5FA, 1),   // (üó∫Ô∏è)       world map
        NVC_UI_CHAR_RANGE(0x1F5FB, 5),   // (üóª..üóø)   mount fuji
        NVC_UI_CHAR_RANGE(0x1F600, 1),   // (üòÄ)       grinning face
        NVC_UI_CHAR_RANGE(0x1F601, 6),   // (üòÅ..üòÜ)   beaming face with smiling eyes squinting face
        NVC_UI_CHAR_RANGE(0x1F607, 2),   // (üòá..üòà)   smiling face with halo face with horns
        NVC_UI_CHAR_RANGE(0x1F609, 5),   // (üòâ..üòç)   winking face face with heart-eyes
        NVC_UI_CHAR_RANGE(0x1F60E, 1),   // (üòé)       smiling face with sunglasses
        NVC_UI_CHAR_RANGE(0x1F60F, 1),   // (üòè)       smirking face
        NVC_UI_CHAR_RANGE(0x1F610, 1),   // (üòê)       neutral face
        NVC_UI_CHAR_RANGE(0x1F611, 1),   // (üòë)       expressionless face
        NVC_UI_CHAR_RANGE(0x1F612, 3),   // (üòí..üòî)   unamused face face
        NVC_UI_CHAR_RANGE(0x1F615, 1),   // (üòï)       confused face
        NVC_UI_CHAR_RANGE(0x1F616, 1),   // (üòñ)       confounded face
        NVC_UI_CHAR_RANGE(0x1F617, 1),   // (üòó)       kissing face
        NVC_UI_CHAR_RANGE(0x1F618, 1),   // (üòò)       face blowing a kiss
        NVC_UI_CHAR_RANGE(0x1F619, 1),   // (üòô)       kissing face with smiling eyes
        NVC_UI_CHAR_RANGE(0x1F61A, 1),   // (üòö)       kissing face with closed eyes
        NVC_UI_CHAR_RANGE(0x1F61B, 1),   // (üòõ)       face with tongue
        NVC_UI_CHAR_RANGE(0x1F61C, 3),   // (üòú..üòû)   winking face with tongue face
        NVC_UI_CHAR_RANGE(0x1F61F, 1),   // (üòü)       worried face
        NVC_UI_CHAR_RANGE(0x1F620, 6),   // (üò†..üò•)   angry face but relieved face
        NVC_UI_CHAR_RANGE(0x1F626, 2),   // (üò¶..üòß)   frowning face with open mouth face
        NVC_UI_CHAR_RANGE(0x1F628, 4),   // (üò®..üò´)   fearful face face
        NVC_UI_CHAR_RANGE(0x1F62C, 1),   // (üò¨)       grimacing face
        NVC_UI_CHAR_RANGE(0x1F62D, 1),   // (üò≠)       loudly crying face
        NVC_UI_CHAR_RANGE(0x1F62E, 2),   // (üòÆ..üòØ)   face with open mouth face
        NVC_UI_CHAR_RANGE(0x1F630, 4),   // (üò∞..üò≥)   anxious face with sweat face
        NVC_UI_CHAR_RANGE(0x1F634, 1),   // (üò¥)       sleeping face
        NVC_UI_CHAR_RANGE(0x1F635, 1),   // (üòµ)       face with crossed-out eyes
        NVC_UI_CHAR_RANGE(0x1F636, 1),   // (üò∂)       face without mouth
        NVC_UI_CHAR_RANGE(0x1F637, 10),  // (üò∑..üôÄ)   face with medical mask cat
        NVC_UI_CHAR_RANGE(0x1F641, 4),   // (üôÅ..üôÑ)   slightly frowning face with rolling eyes
        NVC_UI_CHAR_RANGE(0x1F645, 11),  // (üôÖ..üôè)   person gesturing NO hands
        NVC_UI_CHAR_RANGE(0x1F680, 1),   // (üöÄ)       rocket
        NVC_UI_CHAR_RANGE(0x1F681, 2),   // (üöÅ..üöÇ)   helicopter
        NVC_UI_CHAR_RANGE(0x1F683, 3),   // (üöÉ..üöÖ)   railway car train
        NVC_UI_CHAR_RANGE(0x1F686, 1),   // (üöÜ)       train
        NVC_UI_CHAR_RANGE(0x1F687, 1),   // (üöá)       metro
        NVC_UI_CHAR_RANGE(0x1F688, 1),   // (üöà)       light rail
        NVC_UI_CHAR_RANGE(0x1F689, 1),   // (üöâ)       station
        NVC_UI_CHAR_RANGE(0x1F68A, 2),   // (üöä..üöã)   tram car
        NVC_UI_CHAR_RANGE(0x1F68C, 1),   // (üöå)       bus
        NVC_UI_CHAR_RANGE(0x1F68D, 1),   // (üöç)       oncoming bus
        NVC_UI_CHAR_RANGE(0x1F68E, 1),   // (üöé)       trolleybus
        NVC_UI_CHAR_RANGE(0x1F68F, 1),   // (üöè)       bus stop
        NVC_UI_CHAR_RANGE(0x1F690, 1),   // (üöê)       minibus
        NVC_UI_CHAR_RANGE(0x1F691, 3),   // (üöë..üöì)   ambulance car
        NVC_UI_CHAR_RANGE(0x1F694, 1),   // (üöî)       oncoming police car
        NVC_UI_CHAR_RANGE(0x1F695, 1),   // (üöï)       taxi
        NVC_UI_CHAR_RANGE(0x1F696, 1),   // (üöñ)       oncoming taxi
        NVC_UI_CHAR_RANGE(0x1F697, 1),   // (üöó)       automobile
        NVC_UI_CHAR_RANGE(0x1F698, 1),   // (üöò)       oncoming automobile
        NVC_UI_CHAR_RANGE(0x1F699, 2),   // (üöô..üöö)   sport utility vehicle truck
        NVC_UI_CHAR_RANGE(0x1F69B, 7),   // (üöõ..üö°)   articulated lorry tramway
        NVC_UI_CHAR_RANGE(0x1F6A2, 1),   // (üö¢)       ship
        NVC_UI_CHAR_RANGE(0x1F6A3, 1),   // (üö£)       person rowing boat
        NVC_UI_CHAR_RANGE(0x1F6A4, 2),   // (üö§..üö•)   speedboat traffic light
        NVC_UI_CHAR_RANGE(0x1F6A6, 1),   // (üö¶)       vertical traffic light
        NVC_UI_CHAR_RANGE(0x1F6A7, 7),   // (üöß..üö≠)   construction smoking
        NVC_UI_CHAR_RANGE(0x1F6AE, 4),   // (üöÆ..üö±)   litter in bin sign-potable water
        NVC_UI_CHAR_RANGE(0x1F6B2, 1),   // (üö≤)       bicycle
        NVC_UI_CHAR_RANGE(0x1F6B3, 3),   // (üö≥..üöµ)   no bicycles mountain biking
        NVC_UI_CHAR_RANGE(0x1F6B6, 1),   // (üö∂)       person walking
        NVC_UI_CHAR_RANGE(0x1F6B7, 2),   // (üö∑..üö∏)   no pedestrians crossing
        NVC_UI_CHAR_RANGE(0x1F6B9, 6),   // (üöπ..üöæ)   men‚Äôs room closet
        NVC_UI_CHAR_RANGE(0x1F6BF, 1),   // (üöø)       shower
        NVC_UI_CHAR_RANGE(0x1F6C0, 1),   // (üõÄ)       person taking bath
        NVC_UI_CHAR_RANGE(0x1F6C1, 5),   // (üõÅ..üõÖ)   bathtub luggage
        NVC_UI_CHAR_RANGE(0x1F6CB, 1),   // (üõãÔ∏è)       couch and lamp
        NVC_UI_CHAR_RANGE(0x1F6CC, 1),   // (üõå)       person in bed
        NVC_UI_CHAR_RANGE(0x1F6CD, 3),   // (üõçÔ∏è..üõèÔ∏è)   shopping bags
        NVC_UI_CHAR_RANGE(0x1F6D0, 1),   // (üõê)       place of worship
        NVC_UI_CHAR_RANGE(0x1F6D1, 2),   // (üõë..üõí)   stop sign cart
        NVC_UI_CHAR_RANGE(0x1F6D5, 1),   // (üõï)       hindu temple
        NVC_UI_CHAR_RANGE(0x1F6D6, 2),   // (üõñ..üõó)   hut
        NVC_UI_CHAR_RANGE(0x1F6DC, 1),   // (üõú)       wireless
        NVC_UI_CHAR_RANGE(0x1F6DD, 3),   // (üõù..üõü)   playground slide buoy
        NVC_UI_CHAR_RANGE(0x1F6E0, 6),   // (üõ†Ô∏è..üõ•Ô∏è)   hammer and wrench boat
        NVC_UI_CHAR_RANGE(0x1F6E9, 1),   // (üõ©Ô∏è)       small airplane
        NVC_UI_CHAR_RANGE(0x1F6EB, 2),   // (üõ´..üõ¨)   airplane departure arrival
        NVC_UI_CHAR_RANGE(0x1F6F0, 1),   // (üõ∞Ô∏è)       satellite
        NVC_UI_CHAR_RANGE(0x1F6F3, 1),   // (üõ≥Ô∏è)       passenger ship
        NVC_UI_CHAR_RANGE(0x1F6F4, 3),   // (üõ¥..üõ∂)   kick scooter
        NVC_UI_CHAR_RANGE(0x1F6F7, 2),   // (üõ∑..üõ∏)   sled saucer
        NVC_UI_CHAR_RANGE(0x1F6F9, 1),   // (üõπ)       skateboard
        NVC_UI_CHAR_RANGE(0x1F6FA, 1),   // (üõ∫)       auto rickshaw
        NVC_UI_CHAR_RANGE(0x1F6FB, 2),   // (üõª..üõº)   pickup truck skate
        NVC_UI_CHAR_RANGE(0x1F7E0, 12),  // (üü†..üü´)   orange circle square
        NVC_UI_CHAR_RANGE(0x1F7F0, 1),   // (üü∞)       heavy equals sign
        NVC_UI_CHAR_RANGE(0x1F90C, 1),   // (ü§å)       pinched fingers
        NVC_UI_CHAR_RANGE(0x1F90D, 3),   // (ü§ç..ü§è)   white heart hand
        NVC_UI_CHAR_RANGE(0x1F910, 9),   // (ü§ê..ü§ò)   zipper-mouth face of the horns
        NVC_UI_CHAR_RANGE(0x1F919, 6),   // (ü§ô..ü§û)   call me hand fingers
        NVC_UI_CHAR_RANGE(0x1F91F, 1),   // (ü§ü)       love-you gesture
        NVC_UI_CHAR_RANGE(0x1F920, 8),   // (ü§†..ü§ß)   cowboy hat face face
        NVC_UI_CHAR_RANGE(0x1F928, 8),   // (ü§®..ü§Ø)   face with raised eyebrow head
        NVC_UI_CHAR_RANGE(0x1F930, 1),   // (ü§∞)       pregnant woman
        NVC_UI_CHAR_RANGE(0x1F931, 2),   // (ü§±..ü§≤)   breast-feeding up together
        NVC_UI_CHAR_RANGE(0x1F933, 8),   // (ü§≥..ü§∫)   selfie fencing
        NVC_UI_CHAR_RANGE(0x1F93C, 3),   // (ü§º..ü§æ)   people wrestling playing handball
        NVC_UI_CHAR_RANGE(0x1F93F, 1),   // (ü§ø)       diving mask
        NVC_UI_CHAR_RANGE(0x1F940, 6),   // (ü•Ä..ü•Ö)   wilted flower net
        NVC_UI_CHAR_RANGE(0x1F947, 5),   // (ü•á..ü•ã)   1st place medal arts uniform
        NVC_UI_CHAR_RANGE(0x1F94C, 1),   // (ü•å)       curling stone
        NVC_UI_CHAR_RANGE(0x1F94D, 3),   // (ü•ç..ü•è)   lacrosse disc
        NVC_UI_CHAR_RANGE(0x1F950, 15),  // (ü•ê..ü•û)   croissant
        NVC_UI_CHAR_RANGE(0x1F95F, 13),  // (ü•ü..ü•´)   dumpling food
        NVC_UI_CHAR_RANGE(0x1F96C, 5),   // (ü•¨..ü•∞)   leafy green face with hearts
        NVC_UI_CHAR_RANGE(0x1F971, 1),   // (ü•±)       yawning face
        NVC_UI_CHAR_RANGE(0x1F972, 1),   // (ü•≤)       smiling face with tear
        NVC_UI_CHAR_RANGE(0x1F973, 4),   // (ü•≥..ü•∂)   partying face face
        NVC_UI_CHAR_RANGE(0x1F977, 2),   // (ü•∑..ü•∏)   ninja face
        NVC_UI_CHAR_RANGE(0x1F979, 1),   // (ü•π)       face holding back tears
        NVC_UI_CHAR_RANGE(0x1F97A, 1),   // (ü•∫)       pleading face
        NVC_UI_CHAR_RANGE(0x1F97B, 1),   // (ü•ª)       sari
        NVC_UI_CHAR_RANGE(0x1F97C, 4),   // (ü•º..ü•ø)   lab coat shoe
        NVC_UI_CHAR_RANGE(0x1F980, 5),   // (ü¶Ä..ü¶Ñ)   crab
        NVC_UI_CHAR_RANGE(0x1F985, 13),  // (ü¶Ö..ü¶ë)   eagle
        NVC_UI_CHAR_RANGE(0x1F992, 6),   // (ü¶í..ü¶ó)   giraffe
        NVC_UI_CHAR_RANGE(0x1F998, 11),  // (ü¶ò..ü¶¢)   kangaroo
        NVC_UI_CHAR_RANGE(0x1F9A3, 2),   // (ü¶£..ü¶§)   mammoth
        NVC_UI_CHAR_RANGE(0x1F9A5, 6),   // (ü¶•..ü¶™)   sloth
        NVC_UI_CHAR_RANGE(0x1F9AB, 3),   // (ü¶´..ü¶≠)   beaver
        NVC_UI_CHAR_RANGE(0x1F9AE, 2),   // (ü¶Æ..ü¶Ø)   guide dog cane
        NVC_UI_CHAR_RANGE(0x1F9B0, 10),  // (ü¶∞..ü¶π)   red hair
        NVC_UI_CHAR_RANGE(0x1F9BA, 6),   // (ü¶∫..ü¶ø)   safety vest leg
        NVC_UI_CHAR_RANGE(0x1F9C0, 1),   // (üßÄ)       cheese wedge
        NVC_UI_CHAR_RANGE(0x1F9C1, 2),   // (üßÅ..üßÇ)   cupcake
        NVC_UI_CHAR_RANGE(0x1F9C3, 8),   // (üßÉ..üßä)   beverage box
        NVC_UI_CHAR_RANGE(0x1F9CB, 1),   // (üßã)       bubble tea
        NVC_UI_CHAR_RANGE(0x1F9CC, 1),   // (üßå)       troll
        NVC_UI_CHAR_RANGE(0x1F9CD, 3),   // (üßç..üßè)   person standing person
        NVC_UI_CHAR_RANGE(0x1F9D0, 23),  // (üßê..üß¶)   face with monocle
        NVC_UI_CHAR_RANGE(0x1F9E7, 25),  // (üßß..üßø)   red envelope amulet
        NVC_UI_CHAR_RANGE(0x1FA70, 4),   // (ü©∞..ü©≥)   ballet shoes
        NVC_UI_CHAR_RANGE(0x1FA74, 1),   // (ü©¥)       thong sandal
        NVC_UI_CHAR_RANGE(0x1FA75, 3),   // (ü©µ..ü©∑)   light blue heart heart
        NVC_UI_CHAR_RANGE(0x1FA78, 3),   // (ü©∏..ü©∫)   drop of blood
        NVC_UI_CHAR_RANGE(0x1FA7B, 2),   // (ü©ª..ü©º)   x-ray
        NVC_UI_CHAR_RANGE(0x1FA80, 3),   // (ü™Ä..ü™Ç)   yo-yo
        NVC_UI_CHAR_RANGE(0x1FA83, 4),   // (ü™É..ü™Ü)   boomerang dolls
        NVC_UI_CHAR_RANGE(0x1FA87, 2),   // (ü™á..ü™à)   maracas
        NVC_UI_CHAR_RANGE(0x1FA90, 6),   // (ü™ê..ü™ï)   ringed planet
        NVC_UI_CHAR_RANGE(0x1FA96, 19),  // (ü™ñ..ü™®)   military helmet
        NVC_UI_CHAR_RANGE(0x1FAA9, 4),   // (ü™©..ü™¨)   mirror ball
        NVC_UI_CHAR_RANGE(0x1FAAD, 3),   // (ü™≠..ü™Ø)   folding hand fan
        NVC_UI_CHAR_RANGE(0x1FAB0, 7),   // (ü™∞..ü™∂)   fly
        NVC_UI_CHAR_RANGE(0x1FAB7, 4),   // (ü™∑..ü™∫)   lotus with eggs
        NVC_UI_CHAR_RANGE(0x1FABB, 3),   // (ü™ª..ü™Ω)   hyacinth
        NVC_UI_CHAR_RANGE(0x1FABF, 1),   // (ü™ø)       goose
        NVC_UI_CHAR_RANGE(0x1FAC0, 3),   // (ü´Ä..ü´Ç)   anatomical heart hugging
        NVC_UI_CHAR_RANGE(0x1FAC3, 3),   // (ü´É..ü´Ö)   pregnant man with crown
        NVC_UI_CHAR_RANGE(0x1FACE, 2),   // (ü´é..ü´è)   moose
        NVC_UI_CHAR_RANGE(0x1FAD0, 7),   // (ü´ê..ü´ñ)   blueberries
        NVC_UI_CHAR_RANGE(0x1FAD7, 3),   // (ü´ó..ü´ô)   pouring liquid
        NVC_UI_CHAR_RANGE(0x1FADA, 2),   // (ü´ö..ü´õ)   ginger root pod
        NVC_UI_CHAR_RANGE(0x1FAE0, 8),   // (ü´†..ü´ß)   melting face
        NVC_UI_CHAR_RANGE(0x1FAE8, 1),   // (ü´®)       shaking face
        NVC_UI_CHAR_RANGE(0x1FAF0, 7),   // (ü´∞..ü´∂)   hand with index finger and thumb crossed hands
        NVC_UI_CHAR_RANGE(0x1FAF7, 2),   // (ü´∑..ü´∏)   leftwards pushing hand pushing hand
    };
    m_emojiSet = CFCharacterSetCreateMutable(kCFAllocatorDefault);
    if (likely(m_emojiSet != nullptr)) {
        for (int i = 0; i < countof(emojis); i++) {
            CFCharacterSetAddCharactersInRange(m_emojiSet, emojis[i]);
        }
        bool x = is_emoji(0x2194);
        x = false;
        
    }
}

}

